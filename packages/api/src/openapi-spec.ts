// Auto-generated from packages/api/openapi/openapi.yaml
export const FULL_OPENAPI_SPEC = "openapi: 3.1.0\ninfo:\n  title: CariCash Nova API\n  version: 0.2.0\n  description: |\n    CariCash Nova — Barbados-based mobile payments platform API.\n\n    ## Key Concepts\n    - **Jurisdiction**: Barbados. Base currency: BBD. NO FX — cross-currency postings rejected.\n    - **Closed-loop wallets**: Customers, agents, and merchants hold balances internally.\n    - **Double-entry ledger**: Every transaction posts balanced journal entries (sum DR = sum CR).\n    - **Idempotency**: All money-moving endpoints require `idempotency_key`. Retries with same key+payload return cached result; same key+different payload returns 409 DUPLICATE_IDEMPOTENCY_CONFLICT.\n    - **Maker-checker**: Reversals, manual adjustments, overdraft facilities, fee/commission changes require dual approval (maker ≠ checker).\n    - **Posting via Durable Object**: All money movement routes through a serialized Durable Object per wallet-per-currency.\n  contact:\n    name: CariCash Engineering\n    email: engineering@caricash.bb\n  license:\n    name: MIT\n\nservers:\n  - url: http://localhost:8787\n    description: Local development (wrangler dev)\n\ntags:\n  - name: Auth\n    description: Authentication endpoints for all actor types\n  - name: Customers\n    description: Customer registration and KYC management\n  - name: Agents\n    description: Agent registration\n  - name: Merchants\n    description: Merchant registration\n  - name: Wallets\n    description: Wallet balance and statement queries\n  - name: Transactions\n    description: Money movement — deposit, withdrawal, P2P, payment, B2B, reversal\n  - name: Approvals\n    description: Maker-checker approval workflow\n  - name: Ops\n    description: Staff-only operational endpoints\n  - name: Reconciliation\n    description: Staff-only reconciliation and integrity verification\n  - name: Overdraft\n    description: Staff-only overdraft facility management (maker-checker)\n\nsecurity: []\n\npaths:\n  # ============================================================\n  #  AUTH\n  # ============================================================\n  /auth/customer/login:\n    post:\n      operationId: customerLogin\n      tags: [Auth]\n      summary: Customer login\n      description: Authenticate a customer using MSISDN and PIN.\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/CustomerLoginRequest'\n            example:\n              msisdn: '+12465551234'\n              pin: '1234'\n      responses:\n        '200':\n          description: Login successful\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/LoginResponse'\n              example:\n                token: '01HZ...'\n                actor_id: '01HZ...'\n                actor_type: CUSTOMER\n                session_id: '01HZ...'\n                correlation_id: '01HZ...'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '401':\n          $ref: '#/components/responses/Unauthorized'\n        '423':\n          description: Account locked\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '429':\n          $ref: '#/components/responses/RateLimited'\n\n  /auth/agent/login:\n    post:\n      operationId: agentLogin\n      tags: [Auth]\n      summary: Agent login\n      description: Authenticate an agent using agent_code and PIN.\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/AgentLoginRequest'\n            example:\n              agent_code: 'AGT001'\n              pin: '5678'\n      responses:\n        '200':\n          description: Login successful\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/LoginResponse'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '401':\n          $ref: '#/components/responses/Unauthorized'\n        '423':\n          description: Account locked\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '429':\n          $ref: '#/components/responses/RateLimited'\n\n  /auth/merchant/login:\n    post:\n      operationId: merchantLogin\n      tags: [Auth]\n      summary: Merchant login\n      description: Authenticate a merchant using store_code and PIN.\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/MerchantLoginRequest'\n            example:\n              store_code: 'STORE001'\n              pin: '9012'\n      responses:\n        '200':\n          description: Login successful\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/LoginResponse'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '401':\n          $ref: '#/components/responses/Unauthorized'\n        '423':\n          description: Account locked\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '429':\n          $ref: '#/components/responses/RateLimited'\n\n  /auth/staff/login:\n    post:\n      operationId: staffLogin\n      tags: [Auth]\n      summary: Staff login\n      description: Authenticate staff using staff_code and PIN. (OAuth stub — real IdP integration planned.)\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/StaffLoginRequest'\n            example:\n              staff_code: 'STAFF001'\n              pin: '3456'\n      responses:\n        '200':\n          description: Login successful\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/LoginResponse'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '401':\n          $ref: '#/components/responses/Unauthorized'\n        '429':\n          $ref: '#/components/responses/RateLimited'\n\n  # ============================================================\n  #  CUSTOMERS\n  # ============================================================\n  /customers:\n    post:\n      operationId: createCustomer\n      tags: [Customers]\n      summary: Register a new customer\n      description: Create a customer account with MSISDN, name, and PIN. Automatically creates a BBD wallet.\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/CreateCustomerRequest'\n            example:\n              msisdn: '+12465559999'\n              name: 'Jane Doe'\n              pin: '1234'\n              correlation_id: '01HZ...'\n      responses:\n        '201':\n          description: Customer created\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/CreateCustomerResponse'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '409':\n          description: Customer with this MSISDN already exists\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /customers/{customerId}:\n    get:\n      operationId: getCustomer\n      tags: [Customers]\n      summary: Get customer details\n      description: Retrieve customer profile by ID. Returns 501 (stub).\n      parameters:\n        - $ref: '#/components/parameters/customerId'\n      responses:\n        '200':\n          description: Customer details\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ActorResponse'\n        '404':\n          $ref: '#/components/responses/NotFound'\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /customers/{customerId}/kyc/initiate:\n    post:\n      operationId: initiateCustomerKyc\n      tags: [Customers]\n      summary: Initiate customer KYC\n      description: Submit KYC documents for a customer. Updates kyc_state to PENDING.\n      parameters:\n        - $ref: '#/components/parameters/customerId'\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/KycInitiateRequest'\n            example:\n              document_type: 'NATIONAL_ID'\n              document_number: 'BB123456'\n              correlation_id: '01HZ...'\n      responses:\n        '200':\n          description: KYC initiated\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/KycInitiateResponse'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n\n  /customers/{customerId}/kyc:\n    get:\n      operationId: getCustomerKyc\n      tags: [Customers]\n      summary: Get customer KYC status\n      description: Retrieve KYC status for a customer. Returns 501 (stub).\n      parameters:\n        - $ref: '#/components/parameters/customerId'\n      responses:\n        '200':\n          description: KYC profile\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/KycProfileResponse'\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  # ============================================================\n  #  AGENTS\n  # ============================================================\n  /agents:\n    post:\n      operationId: createAgent\n      tags: [Agents]\n      summary: Register a new agent\n      description: Create an agent account with agent_code, name, MSISDN, PIN, and agent_type. Automatically creates WALLET + CASH_FLOAT accounts.\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/CreateAgentRequest'\n            example:\n              agent_code: 'AGT002'\n              name: 'Agent Smith'\n              msisdn: '+12465558888'\n              pin: '5678'\n              agent_type: 'STANDARD'\n              correlation_id: '01HZ...'\n      responses:\n        '201':\n          description: Agent created\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/CreateAgentResponse'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '409':\n          description: Agent with this code already exists\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /agents/{agentId}:\n    get:\n      operationId: getAgent\n      tags: [Agents]\n      summary: Get agent details\n      description: Retrieve agent profile by ID. Returns 501 (stub).\n      parameters:\n        - $ref: '#/components/parameters/agentId'\n      responses:\n        '200':\n          description: Agent details\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ActorResponse'\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /agents/{agentId}/kyc/initiate:\n    post:\n      operationId: initiateAgentKyc\n      tags: [Agents]\n      summary: Initiate agent KYC\n      description: Submit KYC documents for an agent. Returns 501 (stub).\n      parameters:\n        - $ref: '#/components/parameters/agentId'\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/KycInitiateRequest'\n      responses:\n        '200':\n          description: KYC initiated\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/KycInitiateResponse'\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /agents/{agentId}/kyc:\n    get:\n      operationId: getAgentKyc\n      tags: [Agents]\n      summary: Get agent KYC status\n      description: Retrieve KYC status for an agent. Returns 501 (stub).\n      parameters:\n        - $ref: '#/components/parameters/agentId'\n      responses:\n        '200':\n          description: KYC profile\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/KycProfileResponse'\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  # ============================================================\n  #  MERCHANTS\n  # ============================================================\n  /merchants:\n    post:\n      operationId: createMerchant\n      tags: [Merchants]\n      summary: Register a new merchant\n      description: Create a merchant account with store_code, name, MSISDN, and PIN. Automatically creates a BBD wallet.\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/CreateMerchantRequest'\n            example:\n              store_code: 'STORE002'\n              name: 'Bob Shop'\n              msisdn: '+12465557777'\n              pin: '9012'\n              correlation_id: '01HZ...'\n      responses:\n        '201':\n          description: Merchant created\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/CreateMerchantResponse'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '409':\n          description: Merchant with this store code already exists\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /merchants/{merchantId}:\n    get:\n      operationId: getMerchant\n      tags: [Merchants]\n      summary: Get merchant details\n      description: Retrieve merchant profile by ID. Returns 501 (stub).\n      parameters:\n        - $ref: '#/components/parameters/merchantId'\n      responses:\n        '200':\n          description: Merchant details\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ActorResponse'\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /merchants/{merchantId}/kyc/initiate:\n    post:\n      operationId: initiateMerchantKyc\n      tags: [Merchants]\n      summary: Initiate merchant KYC\n      description: Submit KYC documents for a merchant. Returns 501 (stub).\n      parameters:\n        - $ref: '#/components/parameters/merchantId'\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/KycInitiateRequest'\n      responses:\n        '200':\n          description: KYC initiated\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/KycInitiateResponse'\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /merchants/{merchantId}/kyc:\n    get:\n      operationId: getMerchantKyc\n      tags: [Merchants]\n      summary: Get merchant KYC status\n      description: Retrieve KYC status for a merchant. Returns 501 (stub).\n      parameters:\n        - $ref: '#/components/parameters/merchantId'\n      responses:\n        '200':\n          description: KYC profile\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/KycProfileResponse'\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /merchants/{merchantId}/stores:\n    post:\n      operationId: createMerchantStore\n      tags: [Merchants]\n      summary: Create a store for merchant\n      description: Add a new store under a merchant. Returns 501 (stub).\n      parameters:\n        - $ref: '#/components/parameters/merchantId'\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              type: object\n              required: [store_code, name]\n              properties:\n                store_code:\n                  type: string\n                name:\n                  type: string\n      responses:\n        '201':\n          description: Store created\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  store_id:\n                    type: string\n                  store_code:\n                    type: string\n                  name:\n                    type: string\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n    get:\n      operationId: listMerchantStores\n      tags: [Merchants]\n      summary: List merchant stores\n      description: List stores belonging to a merchant. Returns 501 (stub).\n      parameters:\n        - $ref: '#/components/parameters/merchantId'\n      responses:\n        '200':\n          description: Store list\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  items:\n                    type: array\n                    items:\n                      type: object\n                      properties:\n                        store_id:\n                          type: string\n                        store_code:\n                          type: string\n                        name:\n                          type: string\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /stores/{storeId}:\n    get:\n      operationId: getStore\n      tags: [Merchants]\n      summary: Get store details\n      description: Retrieve store details by ID. Returns 501 (stub).\n      parameters:\n        - name: storeId\n          in: path\n          required: true\n          schema:\n            type: string\n      responses:\n        '200':\n          description: Store details\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  store_id:\n                    type: string\n                  store_code:\n                    type: string\n                  merchant_id:\n                    type: string\n                  name:\n                    type: string\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  # ============================================================\n  #  WALLETS / BALANCES\n  # ============================================================\n  /wallets/{ownerType}/{ownerId}/{currency}/balance:\n    get:\n      operationId: getWalletBalance\n      tags: [Wallets]\n      summary: Get wallet balance\n      description: |\n        Retrieve current balance for a wallet. Balance is derived from the append-only ledger\n        (sum of credits minus sum of debits on the account).\n      parameters:\n        - name: ownerType\n          in: path\n          required: true\n          schema:\n            $ref: '#/components/schemas/OwnerType'\n        - name: ownerId\n          in: path\n          required: true\n          schema:\n            type: string\n        - name: currency\n          in: path\n          required: true\n          schema:\n            $ref: '#/components/schemas/CurrencyCode'\n      responses:\n        '200':\n          description: Balance response\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/BalanceResponse'\n              example:\n                owner_type: CUSTOMER\n                owner_id: '01HZ...'\n                currency: BBD\n                account_id: '01HZ...'\n                balance: '1000.00'\n                correlation_id: '01HZ...'\n        '404':\n          $ref: '#/components/responses/NotFound'\n\n  /wallets/{ownerType}/{ownerId}/{currency}/statement:\n    get:\n      operationId: getWalletStatement\n      tags: [Wallets]\n      summary: Get wallet statement\n      description: Retrieve transaction history for a wallet. Returns 501 (stub).\n      parameters:\n        - name: ownerType\n          in: path\n          required: true\n          schema:\n            $ref: '#/components/schemas/OwnerType'\n        - name: ownerId\n          in: path\n          required: true\n          schema:\n            type: string\n        - name: currency\n          in: path\n          required: true\n          schema:\n            $ref: '#/components/schemas/CurrencyCode'\n        - $ref: '#/components/parameters/cursor'\n        - $ref: '#/components/parameters/pageSize'\n      responses:\n        '200':\n          description: Statement\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/StatementResponse'\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  # ============================================================\n  #  TRANSACTIONS\n  # ============================================================\n  /tx/deposit:\n    post:\n      operationId: createDeposit\n      tags: [Transactions]\n      summary: Agent deposit (cash-in)\n      description: |\n        Agent deposits cash into a customer's wallet. Debits agent cash float, credits customer wallet.\n        Fees and commissions applied based on active fee/commission matrix.\n\n        **Idempotency**: Required. Same `idempotency_key` with same payload returns cached receipt.\n        Same key with different payload returns 409 DUPLICATE_IDEMPOTENCY_CONFLICT.\n\n        **Posting**: Routed through Durable Object for serialized access.\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/DepositRequest'\n            example:\n              agent_id: '01HZ...'\n              customer_msisdn: '+12465551234'\n              amount: '500.00'\n              currency: BBD\n              idempotency_key: 'dep-001'\n              correlation_id: '01HZ...'\n      responses:\n        '201':\n          description: Deposit posted\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/TransactionReceipt'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '404':\n          $ref: '#/components/responses/NotFound'\n        '409':\n          description: Idempotency conflict or insufficient funds\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '422':\n          description: Unbalanced journal or cross-currency attempt\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /tx/withdrawal:\n    post:\n      operationId: createWithdrawal\n      tags: [Transactions]\n      summary: Agent withdrawal (cash-out)\n      description: |\n        Agent withdraws cash from a customer's wallet. Debits customer wallet, credits agent cash float.\n\n        **Idempotency**: Required. **Posting**: Via Durable Object.\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/WithdrawalRequest'\n            example:\n              agent_id: '01HZ...'\n              customer_msisdn: '+12465551234'\n              amount: '200.00'\n              currency: BBD\n              idempotency_key: 'wdl-001'\n              correlation_id: '01HZ...'\n      responses:\n        '201':\n          description: Withdrawal posted\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/TransactionReceipt'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '404':\n          $ref: '#/components/responses/NotFound'\n        '409':\n          description: Idempotency conflict or insufficient funds\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /tx/p2p:\n    post:\n      operationId: createP2P\n      tags: [Transactions]\n      summary: Peer-to-peer transfer\n      description: |\n        Transfer between two customer wallets. Debits sender, credits receiver.\n\n        **Idempotency**: Required. **Posting**: Via Durable Object.\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/P2PRequest'\n            example:\n              sender_msisdn: '+12465551111'\n              receiver_msisdn: '+12465552222'\n              amount: '100.00'\n              currency: BBD\n              idempotency_key: 'p2p-001'\n              correlation_id: '01HZ...'\n      responses:\n        '201':\n          description: P2P transfer posted\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/TransactionReceipt'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '404':\n          $ref: '#/components/responses/NotFound'\n        '409':\n          description: Idempotency conflict or insufficient funds\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /tx/payment:\n    post:\n      operationId: createPayment\n      tags: [Transactions]\n      summary: Customer payment to merchant\n      description: |\n        Customer pays a merchant. Debits customer wallet, credits merchant wallet.\n\n        **Idempotency**: Required. **Posting**: Via Durable Object.\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/PaymentRequest'\n            example:\n              customer_msisdn: '+12465551234'\n              store_code: 'STORE001'\n              amount: '75.00'\n              currency: BBD\n              idempotency_key: 'pay-001'\n              correlation_id: '01HZ...'\n      responses:\n        '201':\n          description: Payment posted\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/TransactionReceipt'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '404':\n          $ref: '#/components/responses/NotFound'\n        '409':\n          description: Idempotency conflict or insufficient funds\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /tx/b2b:\n    post:\n      operationId: createB2B\n      tags: [Transactions]\n      summary: Business-to-business transfer\n      description: |\n        Transfer between two merchant wallets. Debits sender merchant, credits receiver merchant.\n\n        **Idempotency**: Required. **Posting**: Via Durable Object.\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/B2BRequest'\n            example:\n              sender_store_code: 'STORE001'\n              receiver_store_code: 'STORE002'\n              amount: '1000.00'\n              currency: BBD\n              idempotency_key: 'b2b-001'\n              correlation_id: '01HZ...'\n      responses:\n        '201':\n          description: B2B transfer posted\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/TransactionReceipt'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '404':\n          $ref: '#/components/responses/NotFound'\n        '409':\n          description: Idempotency conflict or insufficient funds\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /tx/reversal/request:\n    post:\n      operationId: requestReversal\n      tags: [Transactions]\n      summary: Request transaction reversal\n      description: |\n        Request reversal of a previous transaction. Creates a maker-checker approval request.\n        The reversal is NOT executed until approved by a different staff member.\n\n        **Maker-checker**: Required. Maker cannot approve their own request.\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/ReversalRequest'\n            example:\n              original_journal_id: '01HZ...'\n              reason: 'Customer requested reversal — incorrect amount'\n              staff_id: '01HZ...'\n              idempotency_key: 'rev-001'\n              correlation_id: '01HZ...'\n      responses:\n        '201':\n          description: Reversal request created (PENDING approval)\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ReversalRequestResponse'\n              example:\n                request_id: '01HZ...'\n                state: PENDING\n                correlation_id: '01HZ...'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n\n  /tx/{journalId}:\n    get:\n      operationId: getTransaction\n      tags: [Transactions]\n      summary: Get transaction details\n      description: Retrieve journal details by ID. Returns 501 (stub).\n      parameters:\n        - name: journalId\n          in: path\n          required: true\n          schema:\n            type: string\n      responses:\n        '200':\n          description: Transaction details\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/JournalResponse'\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /tx:\n    get:\n      operationId: listTransactions\n      tags: [Transactions]\n      summary: List transactions\n      description: List transactions with optional filters. Returns 501 (stub).\n      parameters:\n        - name: ownerType\n          in: query\n          schema:\n            $ref: '#/components/schemas/OwnerType'\n        - name: ownerId\n          in: query\n          schema:\n            type: string\n        - name: currency\n          in: query\n          schema:\n            $ref: '#/components/schemas/CurrencyCode'\n        - $ref: '#/components/parameters/cursor'\n        - $ref: '#/components/parameters/pageSize'\n      responses:\n        '200':\n          description: Transaction list\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  items:\n                    type: array\n                    items:\n                      $ref: '#/components/schemas/JournalResponse'\n                  nextCursor:\n                    type: string\n                    nullable: true\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  # ============================================================\n  #  APPROVALS\n  # ============================================================\n  /approvals/{approvalId}/approve:\n    post:\n      operationId: approveRequest\n      tags: [Approvals]\n      summary: Approve a request\n      description: |\n        Approve a pending maker-checker request. The checker (approver) must be different from the maker.\n\n        If the approval is for a REVERSAL_REQUESTED, the reversal is automatically posted upon approval.\n      parameters:\n        - $ref: '#/components/parameters/approvalId'\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/ApprovalActionRequest'\n            example:\n              staff_id: '01HZ_CHECKER...'\n              correlation_id: '01HZ...'\n      responses:\n        '200':\n          description: Request approved\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ApprovalActionResponse'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '403':\n          description: Maker cannot approve own request\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '404':\n          $ref: '#/components/responses/NotFound'\n        '409':\n          description: Request already decided\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /approvals/{approvalId}/reject:\n    post:\n      operationId: rejectRequest\n      tags: [Approvals]\n      summary: Reject a request\n      description: Reject a pending maker-checker request.\n      parameters:\n        - $ref: '#/components/parameters/approvalId'\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/ApprovalRejectRequest'\n            example:\n              staff_id: '01HZ_CHECKER...'\n              reason: 'Amount too large without supporting docs'\n              correlation_id: '01HZ...'\n      responses:\n        '200':\n          description: Request rejected\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ApprovalActionResponse'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '404':\n          $ref: '#/components/responses/NotFound'\n        '409':\n          description: Request already decided\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /approvals:\n    get:\n      operationId: listApprovals\n      tags: [Approvals]\n      summary: List approval requests\n      description: List approval requests with optional status/type filters. Returns 501 (stub).\n      parameters:\n        - name: status\n          in: query\n          schema:\n            $ref: '#/components/schemas/ApprovalStatus'\n        - name: type\n          in: query\n          schema:\n            $ref: '#/components/schemas/ApprovalType'\n        - $ref: '#/components/parameters/cursor'\n        - $ref: '#/components/parameters/pageSize'\n      responses:\n        '200':\n          description: Approval list\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  items:\n                    type: array\n                    items:\n                      $ref: '#/components/schemas/ApprovalResponse'\n                  nextCursor:\n                    type: string\n                    nullable: true\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /approvals/{approvalId}:\n    get:\n      operationId: getApproval\n      tags: [Approvals]\n      summary: Get approval details\n      description: Retrieve a specific approval request by ID. Returns 501 (stub).\n      parameters:\n        - $ref: '#/components/parameters/approvalId'\n      responses:\n        '200':\n          description: Approval details\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ApprovalResponse'\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  # ============================================================\n  #  OPS — Staff-Only\n  # ============================================================\n  /ops/ledger/journal/{journalId}:\n    get:\n      operationId: getOpsJournal\n      tags: [Ops]\n      summary: Inspect ledger journal\n      description: Retrieve journal header and all lines. Staff authentication required (X-Staff-Id header).\n      security:\n        - StaffAuth: []\n      parameters:\n        - name: journalId\n          in: path\n          required: true\n          schema:\n            type: string\n        - $ref: '#/components/parameters/staffIdHeader'\n      responses:\n        '200':\n          description: Journal with lines\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/JournalResponse'\n        '401':\n          $ref: '#/components/responses/StaffRequired'\n        '404':\n          $ref: '#/components/responses/NotFound'\n\n  /ops/ledger/verify:\n    get:\n      operationId: verifyLedgerIntegrity\n      tags: [Ops, Reconciliation]\n      summary: Verify ledger hash chain integrity\n      description: Walk journals sequentially and verify hash chain continuity. Returns integrity report.\n      security:\n        - StaffAuth: []\n      parameters:\n        - name: from\n          in: query\n          schema:\n            type: string\n            format: date-time\n          description: Start timestamp (inclusive)\n        - name: to\n          in: query\n          schema:\n            type: string\n            format: date-time\n          description: End timestamp (inclusive)\n        - $ref: '#/components/parameters/staffIdHeader'\n      responses:\n        '200':\n          description: Integrity verification result\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/IntegrityVerifyResponse'\n        '401':\n          $ref: '#/components/responses/StaffRequired'\n\n  /ops/reconciliation/run:\n    post:\n      operationId: runReconciliation\n      tags: [Reconciliation]\n      summary: Run reconciliation\n      description: Trigger a reconciliation run. Compares ledger-derived balances to materialized balances. Emits alerts for mismatches.\n      security:\n        - StaffAuth: []\n      parameters:\n        - $ref: '#/components/parameters/staffIdHeader'\n      responses:\n        '200':\n          description: Reconciliation result\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ReconciliationRunResponse'\n        '401':\n          $ref: '#/components/responses/StaffRequired'\n\n  /ops/reconciliation/runs:\n    get:\n      operationId: listReconciliationRuns\n      tags: [Reconciliation]\n      summary: List reconciliation runs\n      description: Retrieve all reconciliation run records.\n      security:\n        - StaffAuth: []\n      parameters:\n        - $ref: '#/components/parameters/staffIdHeader'\n      responses:\n        '200':\n          description: List of runs\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  runs:\n                    type: array\n                    items:\n                      $ref: '#/components/schemas/ReconciliationRun'\n                  count:\n                    type: integer\n        '401':\n          $ref: '#/components/responses/StaffRequired'\n\n  /ops/reconciliation/findings:\n    get:\n      operationId: listReconciliationFindings\n      tags: [Reconciliation]\n      summary: List reconciliation findings\n      description: Retrieve reconciliation findings with optional status filter.\n      security:\n        - StaffAuth: []\n      parameters:\n        - name: status\n          in: query\n          schema:\n            type: string\n            enum: [OPEN, ACKNOWLEDGED, RESOLVED]\n        - $ref: '#/components/parameters/staffIdHeader'\n      responses:\n        '200':\n          description: List of findings\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  findings:\n                    type: array\n                    items:\n                      $ref: '#/components/schemas/ReconciliationFinding'\n                  count:\n                    type: integer\n        '401':\n          $ref: '#/components/responses/StaffRequired'\n\n  /ops/repair/idempotency/{journalId}:\n    post:\n      operationId: repairIdempotency\n      tags: [Ops]\n      summary: Repair idempotency record for journal\n      description: |\n        If a journal exists but its idempotency record is missing, safely reconstruct it.\n        Emits REPAIR_PERFORMED event and audit log entry. **Never modifies ledger entries.**\n      security:\n        - StaffAuth: []\n      parameters:\n        - name: journalId\n          in: path\n          required: true\n          schema:\n            type: string\n        - $ref: '#/components/parameters/staffIdHeader'\n      responses:\n        '200':\n          description: Repair result\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/RepairResponse'\n        '401':\n          $ref: '#/components/responses/StaffRequired'\n        '404':\n          $ref: '#/components/responses/NotFound'\n\n  /ops/repair/state/{journalId}:\n    post:\n      operationId: repairState\n      tags: [Ops]\n      summary: Repair stale idempotency state for journal\n      description: |\n        If a journal's idempotency record is stuck in IN_PROGRESS beyond timeout, mark it COMPLETED.\n        Emits STATE_REPAIRED event. **Never modifies ledger entries.**\n      security:\n        - StaffAuth: []\n      parameters:\n        - name: journalId\n          in: path\n          required: true\n          schema:\n            type: string\n        - $ref: '#/components/parameters/staffIdHeader'\n      responses:\n        '200':\n          description: Repair result\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/RepairResponse'\n        '401':\n          $ref: '#/components/responses/StaffRequired'\n        '404':\n          $ref: '#/components/responses/NotFound'\n\n  # ============================================================\n  #  OVERDRAFT (Staff-Only, Maker-Checker)\n  # ============================================================\n  /ops/overdraft/request:\n    post:\n      operationId: requestOverdraft\n      tags: [Overdraft]\n      summary: Request overdraft facility\n      description: |\n        Create an overdraft facility request. Requires maker-checker approval before activation.\n        Creates both the facility (PENDING) and an approval request.\n      security:\n        - StaffAuth: []\n      parameters:\n        - $ref: '#/components/parameters/staffIdHeader'\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/OverdraftFacilityRequest'\n            example:\n              account_id: '01HZ...'\n              limit_amount: '5000.00'\n              currency: BBD\n              correlation_id: '01HZ...'\n      responses:\n        '201':\n          description: Overdraft request created\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/OverdraftRequestResponse'\n        '400':\n          $ref: '#/components/responses/ValidationError'\n        '401':\n          $ref: '#/components/responses/StaffRequired'\n\n  /ops/overdraft/{facilityId}/approve:\n    post:\n      operationId: approveOverdraft\n      tags: [Overdraft]\n      summary: Approve overdraft facility\n      description: |\n        Approve an overdraft facility. **Maker-checker enforced**: approver must differ from requester.\n      security:\n        - StaffAuth: []\n      parameters:\n        - name: facilityId\n          in: path\n          required: true\n          schema:\n            type: string\n        - $ref: '#/components/parameters/staffIdHeader'\n      requestBody:\n        content:\n          application/json:\n            schema:\n              type: object\n              properties:\n                correlation_id:\n                  type: string\n      responses:\n        '200':\n          description: Overdraft approved\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/OverdraftActionResponse'\n        '401':\n          $ref: '#/components/responses/StaffRequired'\n        '403':\n          description: Maker cannot approve own request\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '404':\n          $ref: '#/components/responses/NotFound'\n        '409':\n          description: Already decided\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /ops/overdraft/{facilityId}/reject:\n    post:\n      operationId: rejectOverdraft\n      tags: [Overdraft]\n      summary: Reject overdraft facility\n      description: Reject an overdraft facility request.\n      security:\n        - StaffAuth: []\n      parameters:\n        - name: facilityId\n          in: path\n          required: true\n          schema:\n            type: string\n        - $ref: '#/components/parameters/staffIdHeader'\n      requestBody:\n        content:\n          application/json:\n            schema:\n              type: object\n              properties:\n                reason:\n                  type: string\n                correlation_id:\n                  type: string\n      responses:\n        '200':\n          description: Overdraft rejected\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/OverdraftActionResponse'\n        '401':\n          $ref: '#/components/responses/StaffRequired'\n        '404':\n          $ref: '#/components/responses/NotFound'\n        '409':\n          description: Already decided\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /ops/overdraft:\n    get:\n      operationId: listOverdraftFacilities\n      tags: [Overdraft]\n      summary: List overdraft facilities\n      description: List overdraft facilities with optional filters. Returns 501 (stub).\n      security:\n        - StaffAuth: []\n      parameters:\n        - name: actorType\n          in: query\n          schema:\n            $ref: '#/components/schemas/OwnerType'\n        - name: actorId\n          in: query\n          schema:\n            type: string\n        - name: status\n          in: query\n          schema:\n            type: string\n            enum: [PENDING, ACTIVE, REJECTED]\n        - $ref: '#/components/parameters/staffIdHeader'\n      responses:\n        '200':\n          description: Overdraft list\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  items:\n                    type: array\n                    items:\n                      $ref: '#/components/schemas/OverdraftFacility'\n                  count:\n                    type: integer\n        '401':\n          $ref: '#/components/responses/StaffRequired'\n        '501':\n          description: Not yet implemented\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  # ============================================================\n  #  SERVICE ROOT\n  # ============================================================\n  /:\n    get:\n      operationId: getServiceInfo\n      tags: [Ops]\n      summary: Service info\n      description: Returns service name and version.\n      responses:\n        '200':\n          description: Service info\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  service:\n                    type: string\n                    example: CariCash Nova API\n                  version:\n                    type: string\n                    example: 0.2.0\n\n  /docs:\n    get:\n      operationId: getSwaggerUI\n      tags: [Ops]\n      summary: Swagger UI\n      description: Serves interactive Swagger UI for API documentation.\n      responses:\n        '200':\n          description: HTML page with Swagger UI\n\n  /openapi.yaml:\n    get:\n      operationId: getOpenApiYaml\n      tags: [Ops]\n      summary: OpenAPI spec (YAML)\n      description: Returns the raw OpenAPI 3.1 specification in YAML format.\n      responses:\n        '200':\n          description: OpenAPI YAML spec\n          content:\n            text/yaml:\n              schema:\n                type: string\n\n  /openapi.json:\n    get:\n      operationId: getOpenApiJson\n      tags: [Ops]\n      summary: OpenAPI spec (JSON)\n      description: Returns the OpenAPI 3.1 specification in JSON format.\n      responses:\n        '200':\n          description: OpenAPI JSON spec\n          content:\n            application/json:\n              schema:\n                type: object\n\n# ==============================================================\n#  COMPONENTS\n# ==============================================================\ncomponents:\n  securitySchemes:\n    CustomerAuth:\n      type: http\n      scheme: bearer\n      description: Bearer token obtained from POST /auth/customer/login\n    AgentAuth:\n      type: http\n      scheme: bearer\n      description: Bearer token obtained from POST /auth/agent/login\n    MerchantAuth:\n      type: http\n      scheme: bearer\n      description: Bearer token obtained from POST /auth/merchant/login\n    StaffAuth:\n      type: http\n      scheme: bearer\n      description: Bearer token obtained from POST /auth/staff/login (OAuth stub)\n\n  parameters:\n    customerId:\n      name: customerId\n      in: path\n      required: true\n      schema:\n        type: string\n      description: Customer actor ID (ULID)\n    agentId:\n      name: agentId\n      in: path\n      required: true\n      schema:\n        type: string\n      description: Agent actor ID (ULID)\n    merchantId:\n      name: merchantId\n      in: path\n      required: true\n      schema:\n        type: string\n      description: Merchant actor ID (ULID)\n    approvalId:\n      name: approvalId\n      in: path\n      required: true\n      schema:\n        type: string\n      description: Approval request ID (ULID)\n    staffIdHeader:\n      name: X-Staff-Id\n      in: header\n      required: true\n      schema:\n        type: string\n      description: Staff actor ID for authentication (placeholder — production will use JWT)\n    cursor:\n      name: cursor\n      in: query\n      required: false\n      schema:\n        type: string\n      description: Opaque pagination cursor\n    pageSize:\n      name: pageSize\n      in: query\n      required: false\n      schema:\n        type: integer\n        default: 50\n        minimum: 1\n        maximum: 200\n      description: Number of items per page\n\n  responses:\n    ValidationError:\n      description: Validation error\n      content:\n        application/json:\n          schema:\n            $ref: '#/components/schemas/ErrorResponse'\n          example:\n            error: 'Validation failed'\n            code: VALIDATION_ERROR\n            correlation_id: '01HZ...'\n    Unauthorized:\n      description: Authentication failed\n      content:\n        application/json:\n          schema:\n            $ref: '#/components/schemas/ErrorResponse'\n          example:\n            error: 'Invalid credentials'\n            correlation_id: '01HZ...'\n    NotFound:\n      description: Resource not found\n      content:\n        application/json:\n          schema:\n            $ref: '#/components/schemas/ErrorResponse'\n          example:\n            error: 'Not found'\n            code: NOT_FOUND\n            correlation_id: '01HZ...'\n    StaffRequired:\n      description: Staff authentication required\n      content:\n        application/json:\n          schema:\n            $ref: '#/components/schemas/ErrorResponse'\n          example:\n            error: 'Staff authentication required'\n            code: UNAUTHORIZED\n    RateLimited:\n      description: Rate limit exceeded\n      content:\n        application/json:\n          schema:\n            $ref: '#/components/schemas/ErrorResponse'\n          example:\n            error: 'Rate limit exceeded'\n            correlation_id: '01HZ...'\n\n  schemas:\n    # ---- Enums ----\n    OwnerType:\n      type: string\n      enum: [CUSTOMER, AGENT, MERCHANT, STAFF]\n    ActorType:\n      type: string\n      enum: [CUSTOMER, AGENT, MERCHANT, STAFF]\n    AgentTypeEnum:\n      type: string\n      enum: [STANDARD, AGGREGATOR]\n    TxnType:\n      type: string\n      enum: [DEPOSIT, WITHDRAWAL, P2P, PAYMENT, B2B, REVERSAL, MANUAL_ADJUSTMENT, OVERDRAFT_DRAW]\n    TxnState:\n      type: string\n      enum: [INITIATED, VALIDATED, AUTHORIZED, POSTED, COMPLETED, FAILED, REVERSED, PENDING_APPROVAL]\n    CurrencyCode:\n      type: string\n      enum: [BBD, USD]\n      description: Supported currency codes. BBD is the base currency.\n    ApprovalStatus:\n      type: string\n      enum: [PENDING, APPROVED, REJECTED, EXPIRED]\n    ApprovalType:\n      type: string\n      enum: [REVERSAL_REQUESTED, MANUAL_ADJUSTMENT_REQUESTED, FEE_MATRIX_CHANGE_REQUESTED, COMMISSION_MATRIX_CHANGE_REQUESTED, OVERDRAFT_FACILITY_REQUESTED]\n    KycStatus:\n      type: string\n      enum: [NOT_STARTED, PENDING, APPROVED, REJECTED]\n    ActorState:\n      type: string\n      enum: [PENDING, ACTIVE, SUSPENDED, CLOSED]\n    AccountType:\n      type: string\n      enum: [WALLET, FEE_REVENUE, TAX_PAYABLE, COMMISSIONS_PAYABLE, OVERDRAFT_FACILITY, SUSPENSE, CASH_FLOAT]\n    ErrorCodeEnum:\n      type: string\n      enum:\n        - UNAUTHORIZED\n        - FORBIDDEN\n        - VALIDATION_ERROR\n        - INSUFFICIENT_FUNDS\n        - CROSS_CURRENCY_NOT_ALLOWED\n        - LIMIT_EXCEEDED\n        - KYC_REQUIRED\n        - BLOCKLISTED\n        - DUPLICATE_IDEMPOTENCY_CONFLICT\n        - IDEMPOTENCY_IN_PROGRESS\n        - MAKER_CHECKER_REQUIRED\n        - NOT_FOUND\n        - CONFLICT\n        - INTERNAL_ERROR\n        - UNBALANCED_JOURNAL\n        - JOURNAL_NOT_FOUND\n        - ACCOUNT_NOT_FOUND\n        - MAKER_CHECKER_VIOLATION\n        - APPROVAL_NOT_FOUND\n        - APPROVAL_ALREADY_DECIDED\n        - INVALID_CREDENTIALS\n        - ACCOUNT_LOCKED\n        - RATE_LIMIT_EXCEEDED\n        - SESSION_EXPIRED\n        - ACTOR_NOT_FOUND\n        - ACTOR_SUSPENDED\n        - DUPLICATE_IDENTIFIER\n        - MISSING_REQUIRED_FIELD\n        - RECONCILIATION_MISMATCH\n        - INTEGRITY_VIOLATION\n        - REPAIR_FAILED\n\n    # ---- Error response ----\n    ErrorResponse:\n      type: object\n      required: [error]\n      properties:\n        error:\n          type: string\n          description: Human-readable error message\n        code:\n          $ref: '#/components/schemas/ErrorCodeEnum'\n        name:\n          type: string\n          description: Error class name\n        correlation_id:\n          type: string\n        details:\n          type: object\n          additionalProperties: true\n        retryable:\n          type: boolean\n          default: false\n\n    # ---- Auth requests ----\n    CustomerLoginRequest:\n      type: object\n      required: [msisdn, pin]\n      properties:\n        msisdn:\n          type: string\n          description: Customer phone number\n        pin:\n          type: string\n          description: Customer PIN\n\n    AgentLoginRequest:\n      type: object\n      required: [agent_code, pin]\n      properties:\n        agent_code:\n          type: string\n          description: Agent identifier code\n        pin:\n          type: string\n          description: Agent PIN\n\n    MerchantLoginRequest:\n      type: object\n      required: [store_code, pin]\n      properties:\n        store_code:\n          type: string\n          description: Store identifier code\n        pin:\n          type: string\n          description: Merchant PIN\n\n    StaffLoginRequest:\n      type: object\n      required: [staff_code, pin]\n      properties:\n        staff_code:\n          type: string\n          description: Staff identifier code\n        pin:\n          type: string\n          description: Staff PIN\n\n    LoginResponse:\n      type: object\n      properties:\n        token:\n          type: string\n          description: Bearer token for subsequent requests\n        actor_id:\n          type: string\n        actor_type:\n          $ref: '#/components/schemas/ActorType'\n        session_id:\n          type: string\n        correlation_id:\n          type: string\n\n    # ---- Actor objects ----\n    Actor:\n      type: object\n      properties:\n        id:\n          type: string\n        type:\n          $ref: '#/components/schemas/ActorType'\n        state:\n          $ref: '#/components/schemas/ActorState'\n        msisdn:\n          type: string\n        agent_code:\n          type: string\n        store_code:\n          type: string\n        staff_code:\n          type: string\n        name:\n          type: string\n        kyc_state:\n          $ref: '#/components/schemas/KycStatus'\n        created_at:\n          type: string\n          format: date-time\n        updated_at:\n          type: string\n          format: date-time\n\n    ActorResponse:\n      type: object\n      properties:\n        actor:\n          $ref: '#/components/schemas/Actor'\n        correlation_id:\n          type: string\n\n    # ---- Customer ----\n    CreateCustomerRequest:\n      type: object\n      required: [msisdn, name, pin]\n      properties:\n        msisdn:\n          type: string\n        name:\n          type: string\n        pin:\n          type: string\n        correlation_id:\n          type: string\n        idempotency_key:\n          type: string\n\n    CreateCustomerResponse:\n      type: object\n      properties:\n        actor:\n          $ref: '#/components/schemas/Actor'\n        wallet_id:\n          type: string\n        correlation_id:\n          type: string\n\n    # ---- Agent ----\n    CreateAgentRequest:\n      type: object\n      required: [agent_code, name, msisdn, pin, agent_type]\n      properties:\n        agent_code:\n          type: string\n        name:\n          type: string\n        msisdn:\n          type: string\n        pin:\n          type: string\n        agent_type:\n          $ref: '#/components/schemas/AgentTypeEnum'\n        correlation_id:\n          type: string\n\n    CreateAgentResponse:\n      type: object\n      properties:\n        actor:\n          $ref: '#/components/schemas/Actor'\n        wallet_id:\n          type: string\n        cash_float_id:\n          type: string\n        correlation_id:\n          type: string\n\n    # ---- Merchant ----\n    CreateMerchantRequest:\n      type: object\n      required: [store_code, name, msisdn, pin]\n      properties:\n        store_code:\n          type: string\n        name:\n          type: string\n        msisdn:\n          type: string\n        pin:\n          type: string\n        correlation_id:\n          type: string\n\n    CreateMerchantResponse:\n      type: object\n      properties:\n        actor:\n          $ref: '#/components/schemas/Actor'\n        wallet_id:\n          type: string\n        correlation_id:\n          type: string\n\n    # ---- KYC ----\n    KycInitiateRequest:\n      type: object\n      required: [document_type, document_number]\n      properties:\n        document_type:\n          type: string\n          description: Document type (e.g., NATIONAL_ID, PASSPORT)\n        document_number:\n          type: string\n        correlation_id:\n          type: string\n\n    KycInitiateResponse:\n      type: object\n      properties:\n        actor_id:\n          type: string\n        kyc_state:\n          $ref: '#/components/schemas/KycStatus'\n        correlation_id:\n          type: string\n\n    KycProfileResponse:\n      type: object\n      properties:\n        actor_id:\n          type: string\n        kyc_state:\n          $ref: '#/components/schemas/KycStatus'\n        document_type:\n          type: string\n        document_number:\n          type: string\n\n    # ---- Wallet ----\n    BalanceResponse:\n      type: object\n      properties:\n        owner_type:\n          $ref: '#/components/schemas/OwnerType'\n        owner_id:\n          type: string\n        currency:\n          $ref: '#/components/schemas/CurrencyCode'\n        account_id:\n          type: string\n        balance:\n          type: string\n          description: Decimal string (e.g., \"1000.00\")\n        correlation_id:\n          type: string\n\n    StatementResponse:\n      type: object\n      properties:\n        items:\n          type: array\n          items:\n            $ref: '#/components/schemas/StatementEntry'\n        nextCursor:\n          type: string\n          nullable: true\n\n    StatementEntry:\n      type: object\n      properties:\n        journal_id:\n          type: string\n        txn_type:\n          $ref: '#/components/schemas/TxnType'\n        entry_type:\n          type: string\n          enum: [DR, CR]\n        amount:\n          type: string\n        description:\n          type: string\n        created_at:\n          type: string\n          format: date-time\n\n    # ---- Transaction requests ----\n    DepositRequest:\n      type: object\n      required: [agent_id, customer_msisdn, amount, currency, idempotency_key]\n      properties:\n        agent_id:\n          type: string\n        customer_msisdn:\n          type: string\n        amount:\n          type: string\n          description: Decimal amount (e.g., \"500.00\")\n        currency:\n          $ref: '#/components/schemas/CurrencyCode'\n        idempotency_key:\n          type: string\n          description: Unique key for idempotent retry\n        correlation_id:\n          type: string\n\n    WithdrawalRequest:\n      type: object\n      required: [agent_id, customer_msisdn, amount, currency, idempotency_key]\n      properties:\n        agent_id:\n          type: string\n        customer_msisdn:\n          type: string\n        amount:\n          type: string\n        currency:\n          $ref: '#/components/schemas/CurrencyCode'\n        idempotency_key:\n          type: string\n        correlation_id:\n          type: string\n\n    P2PRequest:\n      type: object\n      required: [sender_msisdn, receiver_msisdn, amount, currency, idempotency_key]\n      properties:\n        sender_msisdn:\n          type: string\n        receiver_msisdn:\n          type: string\n        amount:\n          type: string\n        currency:\n          $ref: '#/components/schemas/CurrencyCode'\n        idempotency_key:\n          type: string\n        correlation_id:\n          type: string\n\n    PaymentRequest:\n      type: object\n      required: [customer_msisdn, store_code, amount, currency, idempotency_key]\n      properties:\n        customer_msisdn:\n          type: string\n        store_code:\n          type: string\n        amount:\n          type: string\n        currency:\n          $ref: '#/components/schemas/CurrencyCode'\n        idempotency_key:\n          type: string\n        correlation_id:\n          type: string\n\n    B2BRequest:\n      type: object\n      required: [sender_store_code, receiver_store_code, amount, currency, idempotency_key]\n      properties:\n        sender_store_code:\n          type: string\n        receiver_store_code:\n          type: string\n        amount:\n          type: string\n        currency:\n          $ref: '#/components/schemas/CurrencyCode'\n        idempotency_key:\n          type: string\n        correlation_id:\n          type: string\n\n    ReversalRequest:\n      type: object\n      required: [original_journal_id, reason, staff_id, idempotency_key]\n      properties:\n        original_journal_id:\n          type: string\n        reason:\n          type: string\n        staff_id:\n          type: string\n        idempotency_key:\n          type: string\n        correlation_id:\n          type: string\n\n    # ---- Transaction receipt ----\n    TransactionReceipt:\n      type: object\n      properties:\n        journal_id:\n          type: string\n        state:\n          $ref: '#/components/schemas/TxnState'\n        txn_type:\n          $ref: '#/components/schemas/TxnType'\n        currency:\n          $ref: '#/components/schemas/CurrencyCode'\n        entries:\n          type: array\n          items:\n            $ref: '#/components/schemas/LedgerLineEntry'\n        created_at:\n          type: string\n          format: date-time\n        correlation_id:\n          type: string\n\n    LedgerLineEntry:\n      type: object\n      properties:\n        account_id:\n          type: string\n        entry_type:\n          type: string\n          enum: [DR, CR]\n        amount:\n          type: string\n        description:\n          type: string\n\n    ReversalRequestResponse:\n      type: object\n      properties:\n        request_id:\n          type: string\n        state:\n          $ref: '#/components/schemas/ApprovalStatus'\n        correlation_id:\n          type: string\n\n    # ---- Journal ----\n    JournalResponse:\n      type: object\n      properties:\n        journal:\n          type: object\n          properties:\n            id:\n              type: string\n            txn_type:\n              $ref: '#/components/schemas/TxnType'\n            currency:\n              $ref: '#/components/schemas/CurrencyCode'\n            correlation_id:\n              type: string\n            idempotency_key:\n              type: string\n            state:\n              $ref: '#/components/schemas/TxnState'\n            description:\n              type: string\n            created_at:\n              type: string\n              format: date-time\n            prev_hash:\n              type: string\n            hash:\n              type: string\n        lines:\n          type: array\n          items:\n            type: object\n            properties:\n              id:\n                type: string\n              journal_id:\n                type: string\n              account_id:\n                type: string\n              entry_type:\n                type: string\n                enum: [DR, CR]\n              amount:\n                type: string\n              description:\n                type: string\n              created_at:\n                type: string\n                format: date-time\n\n    # ---- Approvals ----\n    ApprovalActionRequest:\n      type: object\n      required: [staff_id]\n      properties:\n        staff_id:\n          type: string\n        correlation_id:\n          type: string\n\n    ApprovalRejectRequest:\n      type: object\n      required: [staff_id]\n      properties:\n        staff_id:\n          type: string\n        reason:\n          type: string\n        correlation_id:\n          type: string\n\n    ApprovalActionResponse:\n      type: object\n      properties:\n        request_id:\n          type: string\n        state:\n          $ref: '#/components/schemas/ApprovalStatus'\n        reversal:\n          $ref: '#/components/schemas/TransactionReceipt'\n        correlation_id:\n          type: string\n\n    ApprovalResponse:\n      type: object\n      properties:\n        id:\n          type: string\n        type:\n          $ref: '#/components/schemas/ApprovalType'\n        state:\n          $ref: '#/components/schemas/ApprovalStatus'\n        maker_staff_id:\n          type: string\n        checker_staff_id:\n          type: string\n        payload_json:\n          type: string\n        created_at:\n          type: string\n          format: date-time\n        decided_at:\n          type: string\n          format: date-time\n\n    # ---- Reconciliation ----\n    ReconciliationRun:\n      type: object\n      properties:\n        id:\n          type: string\n        started_at:\n          type: string\n          format: date-time\n        finished_at:\n          type: string\n          format: date-time\n        status:\n          type: string\n          enum: [RUNNING, COMPLETED, FAILED]\n        summary_json:\n          type: string\n\n    ReconciliationFinding:\n      type: object\n      properties:\n        id:\n          type: string\n        run_id:\n          type: string\n        account_id:\n          type: string\n        currency:\n          type: string\n        expected_balance:\n          type: string\n        actual_balance:\n          type: string\n        delta:\n          type: string\n        severity:\n          type: string\n          enum: [INFO, WARNING, CRITICAL, LOW, MEDIUM, HIGH]\n        status:\n          type: string\n          enum: [OPEN, ACKNOWLEDGED, RESOLVED]\n        created_at:\n          type: string\n          format: date-time\n\n    ReconciliationRunResponse:\n      type: object\n      properties:\n        run_id:\n          type: string\n        status:\n          type: string\n        findings_count:\n          type: integer\n        mismatches:\n          type: integer\n\n    # ---- Integrity ----\n    IntegrityVerifyResponse:\n      type: object\n      properties:\n        valid:\n          type: boolean\n        journals_verified:\n          type: integer\n        first_failure:\n          type: object\n          nullable: true\n          properties:\n            journal_id:\n              type: string\n            expected_hash:\n              type: string\n            actual_hash:\n              type: string\n\n    # ---- Repair ----\n    RepairResponse:\n      type: object\n      properties:\n        journal_id:\n          type: string\n        repaired:\n          type: boolean\n        message:\n          type: string\n        correlation_id:\n          type: string\n\n    # ---- Overdraft ----\n    OverdraftFacilityRequest:\n      type: object\n      required: [account_id, limit_amount, currency]\n      properties:\n        account_id:\n          type: string\n        limit_amount:\n          type: string\n        currency:\n          $ref: '#/components/schemas/CurrencyCode'\n        correlation_id:\n          type: string\n\n    OverdraftRequestResponse:\n      type: object\n      properties:\n        facility_id:\n          type: string\n        request_id:\n          type: string\n        state:\n          type: string\n        correlation_id:\n          type: string\n\n    OverdraftActionResponse:\n      type: object\n      properties:\n        request_id:\n          type: string\n        state:\n          $ref: '#/components/schemas/ApprovalStatus'\n        correlation_id:\n          type: string\n\n    OverdraftFacility:\n      type: object\n      properties:\n        id:\n          type: string\n        account_id:\n          type: string\n        limit_amount:\n          type: string\n        currency:\n          $ref: '#/components/schemas/CurrencyCode'\n        state:\n          type: string\n          enum: [PENDING, ACTIVE, REJECTED]\n        maker_staff_id:\n          type: string\n        checker_staff_id:\n          type: string\n        created_at:\n          type: string\n          format: date-time\n";
